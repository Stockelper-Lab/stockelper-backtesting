# ===========================
# Stockelper Backtesting
# ===========================
#
# 사용 방법:
#   1) 이 파일을 `.env`로 복사한 뒤 값을 채우세요.
#   2) docker-compose 사용 시, compose는 자동으로 `.env`를 읽습니다.
#
# NOTE:
# - 결과 적재 DB(stockelper_web)와
# - 백테스트 입력 데이터 DB(가격/공시/지표)가
#   서로 다를 수 있습니다. (현재 구현은 분리 지원)
#

############################
# Server
############################
HOST=0.0.0.0
PORT=21007
DEBUG=false

############################
# Result DB (required)
# - public.backtesting 테이블(잡/결과/해석)을 저장하는 DB
############################
# 예) DATABASE_URL=postgresql://postgres:postgres@54.180.25.182:5432/stockelper_web
DATABASE_URL=postgresql://user:pass@host:5432/stockelper_web

# (선택) schema/table
STOCKELPER_WEB_SCHEMA=public
STOCKELPER_BACKTESTING_TABLE=backtesting

############################
# Source Data DB (required for real backtest)
# - 가격: daily_stock_price (symbol 컬럼)
# - 공시/지표: score_table_dart_idc (stock_code 컬럼)
############################
DB_USER=stockelper
DB_PASSWORD=
DB_HOST=localhost
DB_PORT=5432
DB_NAME=postgres

############################
# Worker
############################
BACKTEST_WORKER_POLL_SECONDS=5
BACKTEST_RESULTS_DIR=outputs/backtesting_results

# OpenAI Agents SDK 기반 오케스트레이션 (필수)
# - 워커는 항상 Agents 파이프라인(파싱/사전검증/감사/리포트)을 사용합니다.
# - OPENAI_API_KEY가 없으면 워커는 시작하지 않습니다.

# Agents SDK 재시도 상한
BACKTEST_AGENT_MAX_RETRIES=2

# Agents 프롬프트 버전(분석 컬럼에 저장)
BACKTEST_AGENT_PROMPT_VERSION=v1

# (선택) 에이전트별 모델 지정 (비우면 SDK 기본 모델 사용)
BACKTEST_AGENT_MODEL_PARSE=
BACKTEST_AGENT_MODEL_ADJUST=
BACKTEST_AGENT_MODEL_AUDIT=
BACKTEST_AGENT_MODEL_REPORT=

# 안전장치:
# - false면 대상 종목을 특정하지 않은 요청(=전체 유니버스 백테스트)을 차단합니다.
ALLOW_FULL_UNIVERSE=false

############################
# OpenAI (Agents SDK)
############################
# (필수) OPENAI_API_KEY=sk-...
#
# (선택) 기본 모델을 전역으로 지정:
# OPENAI_DEFAULT_MODEL=gpt-4.1
#
# (선택) 트레이싱 민감정보 포함 여부:
# OPENAI_AGENTS_TRACE_INCLUDE_SENSITIVE_DATA=false

